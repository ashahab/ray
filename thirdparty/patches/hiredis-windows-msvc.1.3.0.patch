diff --git fmacros.h fmacros.h
index 754a53c..944d97f 100644
--- fmacros.h
+++ fmacros.h
@@ -10,5 +10,7 @@
 /* Enable TCP_KEEPALIVE */
 #define _DARWIN_C_SOURCE
 #endif
-
+#if defined(_MSC_VER) && !defined(__clang__) && !defined(strdup)
+#define strdup _strdup
+#endif
 #endif
diff --git sds.h sds.h
index d9b6761..811e519 100644
--- sds.h
+++ sds.h
@@ -41,7 +41,11 @@ typedef long long ssize_t;
 #define __attribute__(x)
 #endif
 #endif
-
+#if defined(_MSC_VER) && !defined(__clang__)
+#pragma pack(push, 1)
+#pragma push_macro("__attribute__")
+#define __attribute__(A)
+#endif
 #include <sys/types.h>
 #include <stdarg.h>
 #include <stdint.h>
@@ -66,6 +70,10 @@ struct __attribute__ ((__packed__)) sdshdr16 {
     unsigned char flags; /* 3 lsb of type, 5 unused bits */
     char buf[];
 };
+#if defined(_MSC_VER) && !defined(__clang__)
+#pragma pop_macro("__attribute__")
+#pragma pack(pop)
+#endif
 struct __attribute__ ((__packed__)) sdshdr32 {
     uint32_t len; /* used */
     uint32_t alloc; /* excluding the header and null terminator */
